<launch>
    <arg name="use_rviz" default="true" />

    <rosparam file="$(find xbt_bringup)/config/real_controllers.yaml" />

    <!-- Control wrench and frame with one handle -->
    <remap from="cartesian_compliance_controller_follow_trajectory/target_frame" to="target_frame" />
    <remap from="cartesian_compliance_controller_find_surface/target_frame" to="target_frame" />
    <remap from="cartesian_compliance_controller_follow_trajectory/target_wrench" to="target_wrench" />
    <remap from="cartesian_compliance_controller_find_surface/target_wrench" to="target_wrench" />
    <!-- real robot -->
    <include file="$(find homestri_bringup)/launch/a_bot_bringup.launch">
        <arg name="controllers" value="joint_state_controller scaled_pos_joint_traj_controller speed_scaling_state_controller force_torque_sensor_controller" />
        <arg name="stopped_controllers" value="cartesian_compliance_controller_follow_trajectory cartesian_compliance_controller_find_surface" />
        <arg name="use_rviz" value="false" />
    </include>

    <!-- launch realsense -->
    <include file="$(find realsense2_camera)/launch/rs_camera.launch">
    </include>

    <!-- simple moveit planning interface -->
    <include file="$(find xbt_planning_interface)/launch/planning_interface.launch">
    </include>

    <!-- find surface action server -->
    <remap from="find_surface_action_server/target_wrench" to="target_wrench" />
    <remap from="find_surface_action_server/wrench" to="wrench" />
    <node 
        name="find_surface_action_server" 
        pkg="xbt_planning_interface" 
        type="find_surface_action_server" 
        output="screen"
    />

    <!-- launch rviz -->
    <group if="$(arg use_rviz)">
        <arg name="my_rviz" value="-d $(find xbt_bringup)/etc/real_bringup.rviz" />
        <node name="rviz" pkg="rviz" type="rviz" respawn="false" args="$(arg my_rviz)" output="screen" />
    </group>
</launch>